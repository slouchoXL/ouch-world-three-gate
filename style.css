:root{
  --bg:#000;
  --text:#d3d3d3;
  --muted:#757575;
  --chip:#111;
  --chip-border:#444;
}

*{ box-sizing:border-box }
html,body{ height:100% }
html, body { overscroll-behavior-x: none; }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:ui-sans-serif,system-ui,-apple-system,Inter,Roboto,Arial,sans-serif;
  overflow:hidden;
}

/* ---------- Canvas fills screen ---------- */
#webgl{
  position:fixed; inset:0; display:block;
  width:100vw; height:100vh;
}

/* Let our JS receive horizontal drags (mobile) */
#webgl,
#lanes {
  touch-action: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  user-select: none;
}

/* ---------- Hover lanes (JS sizes/positions) ---------- */
#lanes{
  position: fixed; inset: 0;
  pointer-events: none;          /* container ignores events */
  z-index: 10;
}
#lanes .lane{
  position: absolute; top: 0; bottom: 0;
  pointer-events: auto;          /* individual lanes can receive hover */
  cursor: pointer;
}

/* ---------- Footer (icons) ---------- */
/* JS sets --cols to 3, 2, or 1 based on visible groups */
.footer{
  position: fixed;
  left: 0; right: 0; bottom: 12px;
  display: grid;
  grid-template-columns: repeat(var(--cols, 3), 1fr);
  justify-items: center;
  align-items: center;
  width: 100vw;
  z-index: 25;
  pointer-events: auto;
}

.footer .footer-icon{
  font-size: 22px;
  width: 44px; height: 44px; border-radius: 10px;
  border: none;                       /* removed border */
  background: transparent;            /* no chip background */
  color: var(--text);
  display: inline-flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: transform .15s ease, color .15s ease;
}

.footer .footer-icon svg{
  width: 22px; height: 22px;
  display: block;
  fill: currentColor;
}

.footer .footer-icon:hover{
  color: #fff;
  transform: translateY(-1px);
}

.footer-icon:focus{
  outline: 2px solid #888; outline-offset: 2px;
}

/* Make inline SVGs always use the button color (mobile-safe) */
.footer .footer-icon svg,
.footer .footer-icon svg *{
  fill: currentColor !important;
  stroke: currentColor !important;
}

/* Mobile: make sure they render & are tappable */
@media (hover:none){
    .footer { visibility: hidden; }
    .footer.ready { visibility: visible; }
}

  .footer .footer-icon{
    color: #fff;
    -webkit-tap-highlight-color: transparent;
}
  .footer .footer-icon svg{
    width: 20px; height: 20px;
    display: block;
    transform: translateZ(0);        /* nudge WebKit to paint */
    -webkit-transform: translateZ(0);
  }


#pillsRail{
  position: fixed;
  bottom: 62px;
  left: 50%;
  transform: translateX(-50%) translateY(8px);
  z-index: 25;

  background: var(--chip);
  border: none;
  border-radius: 10px;
  box-shadow: 0 10px 24px rgba(0,0,0,0.35);

  /* key changes for intrinsic width */
  display: inline-flex;
  flex-direction: column;
  align-items: stretch;
  width: max-content;          /* === size to the longest pill === */
  width: min(160px, 92vw);           /* safety cap */
  padding: 6px;                /* tighter chrome */

  opacity: 0;
  pointer-events: none;
  transition: opacity .15s ease, transform .15s ease;
}

/* smaller caret to match compact tray */
#pillsRail::after{
  content: "";
  position: absolute;
  bottom: -6px;                /* was -8px */
  left: 50%;
  transform: translateX(-50%);
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-top: 6px solid var(--chip); /* was 8px */
  filter: drop-shadow(0 2px 0 rgba(0,0,0,0.35));
}
/* visible state */
#pillsRail.open{
  opacity: 1;
  pointer-events: auto;
  transform: translateX(-50%) translateY(0);
}

/* ---------- Tray items (pills) ---------- */
#pillsRail .pill{
  display: inline-flex;
  align-items: center;
  gap: 6px;
  width: auto;
  white-space: nowrap;
  text-align: left;
  background: transparent;
  color: var(--text);
  border: none;
  border-radius: 8px;

  /* tighter */
  padding: .35rem .55rem;   /* was .55rem .75rem */
  font-weight: 600;
  font-size: 13px;       /* was 14px */
  line-height: 1.1;

  transition: background-color .12s ease, color .12s ease, transform .12s ease;
}

#pillsRail .pill svg{
  flex-shrink: 0;
  display: block;
  fill: currentColor;
}
#pillsRail .pill + .pill{ margin-top: 6px; } /* was 8px */

@media (hover:none){
  #pillsRail{
    width: min(160px, 92vw);   /* narrower than before */
    padding: 8px;
  }

  /* optional: slightly smaller pills on mobile for extra fit */
  #pillsRail .pill{
    font-size: 12.75px;
    padding: .32rem .5rem;
  }
}

#pillsRail .pill:hover{
  background: rgba(255,255,255,0.05);
  color: #fff;
  transform: translateY(-1px);
}

#pillsRail .pill.active{
  background: rgba(255,255,255,0.08);
  color: #fff;
}

/* ---------- Overlay ---------- */
.modal { position: fixed; inset: 0; z-index: 40; background: rgba(0,0,0,0.66); }
.modal[hidden] { display: none; }
.modal-card {
  max-width: 90%; margin: 6vh auto; background:#0b0b0b; color:#fff;
  padding:15px; border-radius:12px; position: relative;
}
.modal-close {
  position:absolute; top:12px; right:16px; font-size:28px;
  background:none; border:0; color:#fff; cursor:pointer;
}

/* Make overlay roomy for the packs view */
.modal.modal--packs .modal-card {
  width: min(980px, 96vw);
  max-height: 90vh;
  margin: 6vh auto;
}
.modal.modal--packs .modal-body {
  padding: 0;    
  display: flex;
  justify-content: center;
  align-items: flex-start;
  /* let the widget occupy the full area
  overflow: visible;*/
  min-height: 560px;  /* ensure the modal isn’t tiny while widget loads */
}
/* If the modal has [hidden], actually remove it from layout/stacking
.modal[hidden] { display: none !important; }*/

/* Stronger dim when overlay open */
#webgl.dim-3d{
  filter: grayscale(.7) brightness(.55) blur(1px);
  transition: filter .2s ease;
}

/* ---------- a11y focus ---------- */
.footer .footer-icon:focus,
#pillsRail .pill:focus,
.modal-close:focus{
  outline: 2px solid #888; outline-offset: 2px;
}


/* ---------- Motion reduction ---------- */
@media (prefers-reduced-motion: reduce){
  .footer .footer-icon,
  #pillsRail{
    transition: none;
  }
}
/* --- explicit stacking so footer is guaranteed above the canvas on iOS --- */
#webgl{ z-index: 0; }           /* canvas at the bottom of our stack */
#lanes{ z-index: 50; }          /* hover lanes above canvas */
.footer{ z-index: 200; }        /* footer (icons) above lanes */
#pillsRail{ z-index: 210; }     /* tray above footer */
.modal{ z-index: 1000; }        /* overlay on top */

/* iOS safe-area: push footer up so it’s not behind the home indicator */
@supports(padding:max(0px)){
  .footer{
    /* give it breathing room on devices with a home indicator */
    bottom: calc(20px + env(safe-area-inset-bottom));
  }
}

/* Active state highlight for footer icons (desktop + mobile) */
.footer .footer-icon.active {
  color: #fff;  
  transform: scale(1.1); /* white icon */
 background: none;          /* subtle bump */
}

/* Keep hover distinct on desktop */
@media (hover:hover) {
  .footer .footer-icon:hover {
    color: #fff;
    transform: translateY(-1px) scale(1.1);
    background: none;
  }
}

